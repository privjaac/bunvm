#!/usr/bin/env bash

bunvm_msg "üîÑ Actualizando BunVM‚Ä¶"

# actualizar core
if ! curl -fsSL "https://raw.githubusercontent.com/privjaac/bunvm/main/bunvm.sh" \
  -o "$BUNVM_DIR/bunvm.sh"; then
  bunvm_msg_error "‚ùå No se pudo actualizar bunvm.sh"
  exit 1
fi
chmod +x "$BUNVM_DIR/bunvm.sh"

# actualizar comandos
for CMD in install uninstall use list current alias selfupdate; do
  if ! curl -fsSL "https://raw.githubusercontent.com/privjaac/bunvm/main/commands/$CMD" \
    -o "$BUNVM_DIR/commands/$CMD"; then
    bunvm_msg_error "‚ùå No se pudo actualizar comando: $CMD"
    exit 1
  fi
  chmod +x "$BUNVM_DIR/commands/$CMD"
done

# actualizar librer√≠as
for LIB in detect_platform fetch_version messages validate; do
  if ! curl -fsSL "https://raw.githubusercontent.com/privjaac/bunvm/main/lib/$LIB" \
    -o "$BUNVM_DIR/lib/$LIB"; then
    bunvm_msg_error "‚ùå No se pudo actualizar librer√≠a: $LIB"
    exit 1
  fi
  chmod +x "$BUNVM_DIR/lib/$LIB"
done

# actualizar autoenv
if ! curl -fsSL "https://raw.githubusercontent.com/privjaac/bunvm/main/autoload/autoenv.sh" \
  -o "$BUNVM_DIR/autoload/autoenv.sh"; then
  bunvm_msg_error "‚ùå No se pudo actualizar autoenv.sh"
  exit 1
fi
chmod +x "$BUNVM_DIR/autoload/autoenv.sh"

bunvm_msg_success "‚úî BunVM actualizado correctamente."
